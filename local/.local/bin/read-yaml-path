#!/usr/bin/env python
"""Reads a specific path out of a nested YAML document structure.
"""
from __future__ import division
from __future__ import absolute_import
from __future__ import print_function
from __future__ import unicode_literals

import sys
import yaml


def split_path(path_str):
    return path_str.split('.')

def get_deep(obj, path):
    if len(path) < 1:
        return obj
    head, rest_path = path[0], path[1:]
    in_obj = obj[head]
    return get_deep(in_obj, rest_path)


if __name__ == '__main__':
    if len(sys.argv) < 3:
        print('USAGE: read-yaml-path YAML_FILE PATHS...', file=sys.stderr)
        sys.exit(1)

    infile_name = sys.argv[1]
    path_strs = sys.argv[2:]

    with file(infile_name, 'r') as infile:
        doc = yaml.load(infile)
        for path_str in path_strs:
            path = split_path(path_str)
            try:
                print(str(get_deep(doc, path)))
            except KeyError:
                print('could not find path {0!r}'.format(path_str), file=sys.stderr)
