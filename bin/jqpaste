#!/bin/bash

set -e

if [[ "$#" -lt 1 || "$1" == '-h' || "$1" == '--help' ]]
then
    echo "USAGE: $(basename $0) JSON_FILES..."
    echo "Unions JSON objects horizontally across files."
    echo "E.g. first of first file with first of second file..."
    echo "then second of first file with second of second file..."
    exit 1
fi

paste "$@" | jq -R '. / "\t" | map(. | fromjson) | reduce .[] as $o ({}; . + $o)'
